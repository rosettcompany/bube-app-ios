!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{X3zk:function(t,o,i){"use strict";i.r(o),i.d(o,"LoginPageModule",(function(){return S}));var r=i("ofXK"),a=i("TEn/"),s=i("3Pt+"),c=i("tyNb"),l=i("mrSG"),u=i("3EM6"),p=i("fXoL"),g=i("GGTb"),f=i("CmMg"),b=i("54vc"),d=i("up+p"),m=i("xS7M"),h=i("e8h1");function v(e,n){1&e&&p.Jb(0,"ion-spinner",18)}function x(e,n){if(1&e){var t=p.Nb();p.Mb(0,"div",7),p.Mb(1,"ion-button",15),p.Ub("click",(function(){return p.mc(t),p.Xb().cargarLoginApple()})),p.Jb(2,"ion-icon",16),p.Mb(3,"ion-label",10),p.uc(4,"Iniciar sesi\xf3n con Apple"),p.Lb(),p.sc(5,v,1,0,"ion-spinner",17),p.Lb(),p.Lb()}if(2&e){var o=p.Xb();p.yb(1),p.ec("disabled",o.botonApple),p.yb(4),p.ec("ngIf",o.botonApple)}}var y,k,C,M=[{path:"",component:(y=function(){function t(n,o,i,r,a,s,c,l,u,p,g,f){e(this,t),this.router=n,this.facebook=o,this.menu=i,this.apiService=r,this.splashScreen=a,this.platform=s,this.googlePlus=c,this.loadingController=l,this.alertController=u,this.device=p,this.signInWithApple=g,this.storage=f,this.user={},this.respuesta={},this.amigo={},this.idUsuarioLista=[],this.showSingApple=!1,this.botonApple=!1,this.Usuario={id:"",nombreCompleto:"",apellidos:"",telefono:"0",email:"",rutaFoto:"",fechaNacimiento:"",genero:"",password:"",idapple:""},"iOS"==String(this.device.platform)&&Number(String(this.device.version).substring(0,2))>=13&&(this.showSingApple=!0)}var o,i,r;return o=t,(i=[{key:"ionViewDidEnter",value:function(){this.menu.enable(!1),this.splashScreen.hide()}},{key:"ionViewDidLeave",value:function(){this.menu.enable(!0)}},{key:"presentLoading",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create({cssClass:"my-custom-class",message:"Iniciando sesi\xf3n"});case 2:return this.loading=e.sent,e.next=5,this.loading.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"presentAlertSinConexion",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Sin Conexi\xf3n",message:"Intente m\xe1s tarde",buttons:["OK"]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"presentAlert1",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al obtener datos",message:"Intente m\xe1s tarde",buttons:["OK"]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"presentAlert2",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al obtener amigos",message:"Intente m\xe1s tarde",buttons:["OK"]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"presentAlert3",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al registrar usuario",message:e,buttons:["OK"]});case 2:return t=n.sent,n.next=5,t.present();case 5:case"end":return n.stop()}}),n,this)})))}},{key:"presentAlert4",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al insertar amigos",message:"Intente m\xe1s tarde",buttons:["OK"]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"terminosYcondiciones",value:function(){console.log("terminos y condiciones"),this.router.navigate(["./terminos",1])}},{key:"loginFacebook",value:function(){var e=this;this.logoutGmail(),this.presentLoading(),this.facebook.login(["public_profile","user_friends","email"]).then((function(n){console.log(n.status),"connected"==n.status&&e.getInfo()})).catch((function(n){e.loading.dismiss(),e.presentAlertSinConexion(),console.error(n)}))}},{key:"getInfo",value:function(){var e=this;this.facebook.api("/me?fields=id,email,first_name,picture.type(large),last_name,gender,birthday",[]).then((function(n){console.log(n),e.user=n,e.Usuario.id=n.id,e.Usuario.email=null==n.email?"":n.email,e.Usuario.nombreCompleto=n.first_name,e.Usuario.apellidos=null==n.last_name?"":n.last_name,e.Usuario.genero=null==n.gender?"":n.gender,e.Usuario.rutaFoto=null==n.picture.data.url?"":n.picture.data.url,e.Usuario.fechaNacimiento=null==n.birthday?"":n.birthday,e.getFriends()})).catch((function(n){console.error(n),e.loading.dismiss(),e.presentAlert1()}))}},{key:"getFriends",value:function(){var e=this;this.facebook.api("/me/friends?fields=uid,name,picture.type(large)",[]).then((function(n){console.log(n),e.amigo=n,e.verificarUsuarioFB({id:e.Usuario.id})})).catch((function(n){console.error(n),e.loading.dismiss(),e.presentAlert2()}))}},{key:"verificarUsuarioFB",value:function(e){var n=this;this.apiService.verificarUsuarioFB(e).then((function(e){n.loading.dismiss(),n.logearse(e,"fb")})).catch((function(e){console.log(e)}))}},{key:"guardarIdUser",value:function(e,n){var t=this.user.email,o=this.retornarid(e),i=this.retornarFlag(e);this.apiService.setStorage("idusuario",o),this.apiService.setStorage("ind_user",i),this.apiService.setStorage("correo",t),this.apiService.setStorage("usuario",this.Usuario),this.apiService.setStorage("tipoRegistro",n)}},{key:"retornarFlag",value:function(e){var n;return e.find((function(e){n=e.ind_user})),n}},{key:"retornarid",value:function(e){var n;return e.find((function(e){n=e.idusuario})),n}},{key:"logearse",value:function(e,n){var t=this.retornarFlag(e);console.log("ind logearse "+t);var o={state:{nuevoUsuario:this.Usuario,amigo:this.amigo,tipoRegistro:n}};0==t?(console.log("usuario no existe"),this.router.navigate(["validacion-fecha-nacimiento"],o)):(this.guardarIdUser(e,n),3==t?(console.log("usuario nuevo"),this.router.navigate(["./validacionInicio",1],o)):4==t?(console.log("usuario nuevo"),this.router.navigate(["./validacionCorreo"],o)):2==t&&(console.log("usuario antiguo"),this.router.navigate(["./app/inicio"],o)))}},{key:"irOtrosInicios",value:function(){this.router.navigate(["login-elige-sesion"])}},{key:"logoutGmail",value:function(){this.googlePlus.logout()}},{key:"cargarLoginApple",value:function(){this.botonApple=!0,this.eventoLoginApple()}},{key:"eventoLoginApple",value:function(){var e=this;this.apiService.getStorage("apple_activo").then((function(n){e.loginApple()})).catch((function(n){console.log(n),e.loginApple()}))}},{key:"loginApple",value:function(){var e=this;this.signInWithApple.signin({requestedScopes:[u.a.ASAuthorizationScopeFullName,u.a.ASAuthorizationScopeEmail]}).then((function(n){console.log(n),e.apiService.setStorage("apple_activo",1),e.Usuario.nombreCompleto=""==n.fullName.givenName||null==n.fullName.givenName?"":n.fullName.givenName,e.Usuario.apellidos=""==n.fullName.familyName||null==n.fullName.familyName?"":n.fullName.familyName,e.Usuario.email=""==n.email||null==n.email?"":n.email,e.Usuario.rutaFoto="https://firebasestorage.googleapis.com/v0/b/bubeapp.appspot.com/o/ImagenesUsuarios%2Favatar_perfil.jpg?alt=media&token=3757e499-3ff4-4f3a-ba3d-911bde3506f7",e.Usuario.idapple=""==n.user||null==n.user?"":n.user,e.user.email=e.Usuario.email;var t={idapple:e.Usuario.idapple};""==e.Usuario.idapple?e.botonApple=!1:e.postVerificarLoginApple(t)})).catch((function(n){console.error(n),e.botonApple=!1,e.presentApple()}))}},{key:"postVerificarLoginApple",value:function(e){var n=this;this.apiService.postVerificarLoginApple(e).then((function(e){n.botonApple=!1,n.logearse(e,"apple")})).catch((function(e){console.log(e),n.botonApple=!1,n.presentApple()}))}},{key:"presentApple",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Mensaje",message:"Acci\xf3n cancelada",buttons:["OK"]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}}])&&n(o.prototype,i),r&&n(o,r),t}(),y.\u0275fac=function(e){return new(e||y)(p.Ib(c.g),p.Ib(g.a),p.Ib(a.jb),p.Ib(f.a),p.Ib(b.a),p.Ib(a.mb),p.Ib(d.a),p.Ib(a.ib),p.Ib(a.a),p.Ib(m.a),p.Ib(u.b),p.Ib(h.b))},y.\u0275cmp=p.Cb({type:y,selectors:[["app-login"]],decls:32,vars:3,consts:[[3,"translucent"],[3,"fullscreen"],[1,"conteiner-logo"],["src","./assets/Iconos/LogoBube_final.png","alt","logo bube",1,"img-logo"],[1,"titulo-login",2,"font-size","30px"],[1,"titulo-login"],["id","container",2,"margin-top","20px"],[1,"contenedor"],["expand","block",1,"btn-inicio-sesion",3,"click"],["slot","start","name","logo-facebook"],[1,"text-google"],["class","contenedor",4,"ngIf"],[1,"text-inicio-sesion",3,"click"],[1,"info-paragraph"],["fill","clear",1,"btn-terminos",3,"click"],["expand","block",1,"btn-inicio-apple",3,"disabled","click"],["slot","start","name","logo-apple",2,"color","#000"],["name","crescent",4,"ngIf"],["name","crescent"]],template:function(e,n){1&e&&(p.Jb(0,"ion-header",0),p.Mb(1,"ion-content",1),p.Mb(2,"ion-row"),p.Mb(3,"div",2),p.Jb(4,"ion-img",3),p.Mb(5,"ion-label",4),p.uc(6,"\xdanete"),p.Jb(7,"br"),p.Lb(),p.Mb(8,"ion-label",5),p.uc(9,"a la comunidad de Bube"),p.Lb(),p.Lb(),p.Lb(),p.Mb(10,"div",6),p.Mb(11,"div",7),p.Mb(12,"ion-button",8),p.Ub("click",(function(){return n.loginFacebook()})),p.Jb(13,"ion-icon",9),p.Mb(14,"ion-label",10),p.uc(15,"Iniciar sesi\xf3n con Facebook"),p.Lb(),p.Lb(),p.Lb(),p.sc(16,x,6,2,"div",11),p.Mb(17,"ion-row"),p.Mb(18,"ion-col"),p.Mb(19,"ion-label",12),p.Ub("click",(function(){return n.irOtrosInicios()})),p.uc(20," Otros inicios de sesi\xf3n "),p.Lb(),p.Lb(),p.Lb(),p.Jb(21,"br"),p.Mb(22,"ion-row"),p.Mb(23,"ion-col"),p.Mb(24,"ion-label",13),p.uc(25,"Al registrarse est\xe1s de"),p.Jb(26,"br"),p.uc(27," acuerdo con nuestros"),p.Lb(),p.Lb(),p.Lb(),p.Mb(28,"ion-row"),p.Mb(29,"ion-col"),p.Mb(30,"ion-button",14),p.Ub("click",(function(){return n.terminosYcondiciones()})),p.uc(31,"t\xe9rminos y condiciones"),p.Lb(),p.Lb(),p.Lb(),p.Lb(),p.Lb()),2&e&&(p.ec("translucent",!0),p.yb(1),p.ec("fullscreen",!0),p.yb(15),p.ec("ngIf",n.showSingApple))},directives:[a.v,a.q,a.Q,a.x,a.G,a.h,a.w,r.k,a.p,a.Z],styles:["ion-content[_ngcontent-%COMP%]{--background:#121212;color:#fff}.conteiner-logo[_ngcontent-%COMP%]{text-align:center;width:100%;left:0;right:0;top:10%;margin-top:20%}.img-logo[_ngcontent-%COMP%]{width:120px;height:120px;margin:auto auto 20px}#container[_ngcontent-%COMP%]{text-align:center;margin-top:10px;left:0;right:0;top:50%}.btn-terminos[_ngcontent-%COMP%]{--color:#fcac19;background:transparent;font-size:14px;font-family:SFUIDisplay-Regular;text-decoration:underline;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;text-transform:none;width:-webkit-min-content;width:-moz-min-content;width:min-content}.btn-terminos[_ngcontent-%COMP%]:hover{background:transparent;color:#fcbd48}.titulo-login[_ngcontent-%COMP%]{color:#f3f2ed;font-family:SF-UI-Display-Black;font-size:20px;margin-top:20px}.p1[_ngcontent-%COMP%]{color:#fff;font-family:SFUIDisplay-Regular;font-size:20px}.info-paragraph[_ngcontent-%COMP%]{margin-bottom:var(--page-margin);color:#b8b7b7;text-align:left;font-family:SFCompactText-Medium;font-size:14px}.info-paragraph[_ngcontent-%COMP%]:last-child{margin-bottom:0}.text-inicio-sesion[_ngcontent-%COMP%]{color:#f3f2ed;text-align:center;font-family:SFCompactText-Medium;font-weight:100;font-size:20px;text-decoration:underline}.contenedor[_ngcontent-%COMP%]{align-content:center;text-align:center;width:100%}.contenedor[_ngcontent-%COMP%]   .btn-inicio-sesion[_ngcontent-%COMP%]{--background:#1877f2;margin-left:30px;margin-right:30px;margin-bottom:20px;font-size:16px;height:50px;text-transform:none;--border-color:#1877f2;--border-style:solid;--border-width:2px;font-family:SFUIDisplay-Regular;--border-radius:5px;--background-activated:#383838}.contenedor[_ngcontent-%COMP%]   .btn-inicio-sesion[_ngcontent-%COMP%]   .text-google[_ngcontent-%COMP%]{font-family:SFUIDisplay-Regular;color:#fff;font-size:16px}.contenedor[_ngcontent-%COMP%]   .btn-inicio-apple[_ngcontent-%COMP%]{--background:#fff;margin-left:30px;margin-right:30px;margin-bottom:20px;height:50px;text-transform:none;--border-color:#fff;--border-style:solid;--border-width:2px;--border-radius:5px;--background-activated:#383838}.contenedor[_ngcontent-%COMP%]   .btn-inicio-apple[_ngcontent-%COMP%]   .text-google[_ngcontent-%COMP%]{font-family:SFUIDisplay-Regular;color:#000;font-size:16px}"]}),y)}],w=((C=function n(){e(this,n)}).\u0275mod=p.Gb({type:C}),C.\u0275inj=p.Fb({factory:function(e){return new(e||C)},imports:[[c.i.forChild(M)],c.i]}),C),S=((k=function n(){e(this,n)}).\u0275mod=p.Gb({type:k}),k.\u0275inj=p.Fb({factory:function(e){return new(e||k)},imports:[[r.c,s.d,a.gb,w]]}),k)}}])}();