(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{yOQ9:function(t,e,n){"use strict";n.r(e),n.d(e,"AgregarTarjetaPageModule",(function(){return b}));var i=n("ofXK"),o=n("3Pt+"),r=n("TEn/"),a=n("tyNb"),s=n("mrSG"),l=n("fXoL"),c=n("CmMg"),g=n("Q4mC");const u=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,r,a,s){this.toastControler=t,this.apiService=e,this.navCtrl=n,this.loadingCtrl=i,this.servicioAES=o,this.router=r,this.route=a,this.location=s,this.nombre="",this.name="",this.apellido="",this.numero="N\xfamero de tarjeta",this.fecha="",this.cvv="",this.tipo="hola",this.tarjeta={},this.ocultar=!0,this.keyJScrypto="123456$#@$^@1ERF",this.route.queryParams.subscribe(t=>{this.router.getCurrentNavigation().extras.state&&(this.miTarjeta=this.router.getCurrentNavigation().extras.state.tarjeta,this.pantalla=this.router.getCurrentNavigation().extras.state.pantalla,console.log(this.pantalla))})}ngOnInit(){}ionViewWillEnter(){console.log(this.miTarjeta),"0"==this.miTarjeta?(this.nombreBoton="A\xf1adir tarjeta",this.fecha=" "):(this.nombreBoton="Editar tarjeta",this.ponerNumeroEditar(this.miTarjeta.numero),this.ponerNombre(this.miTarjeta.titular),this.ponerFecha(this.miTarjeta.fecha),this.ponerCvv(this.miTarjeta.cvv))}ponerNumeroEditar(t){let e=document.getElementById("txt-numero"),n=String(t).substring(0,4)+" "+String(t).substring(4,8)+" "+String(t).substring(8,12)+" "+String(t).substring(12,16);e.value=n,console.log("numero editar"),console.log(t),this.numero=n}ponerNumero(t){if(null!=t){console.log(t),console.log(String(t).replace(/ /g,""));let n=document.getElementById("txt-numero"),i=document.getElementById("tipo-tarjeta"),o=document.getElementById("cotenedor");var e=String(t);console.log(e.substring(0,1)),"4"==e.substring(0,1)?(console.log("visa"),i.style.display="block",n.style.color="#000",o.style.background="#1c3a24",this.tipo="visa",this.arreglarNumero(t)):"5"==e.substring(0,1)&&(console.log("mastercard"),i.style.display="block",n.style.color="#000",o.style.background="#464545",this.tipo="master",this.arreglarNumero(t))}else console.log("numero vacio")}arreglarNumero(t){let e=document.getElementById("txt-numero");if(" "===String(t).substring(4)&&5==String(t).length)e.value=t,this.numero=t;else if(5==String(t).length){let n=String(t).substring(0,4)+" "+String(t).substring(4);e.value=n,this.numero=n}if(" "===String(t).substring(9)&&10==String(t).length)e.value=t,this.numero=t;else if(10==String(t).length){let n=String(t).substring(0,9)+" "+String(t).substring(9);e.value=n,this.numero=n}if(" "===String(t).substring(14)&&15==String(t).length)e.value=t,this.numero=t;else if(15==String(t).length){let n=String(t).substring(0,14)+" "+String(t).substring(14);e.value=n,this.numero=n}else this.numero=t}ponerNombre(t){null!=t?this.nombre=String(t):console.log("nombre vacio")}ponerCvv(t){this.cvv=String(t)}ponerFecha(t){let e=document.getElementById("txt-fecha");"/"===String(t).substring(2)&&3==String(t).length?e.value=t:3==String(t).length&&(e.value=String(t).substring(0,2)+"/"+String(t).substring(2)),console.log(String(t).substring(2)),this.fecha=String(t)}insertarTarjeta(){return Object(s.a)(this,void 0,void 0,(function*(){var t=!1,e=!1,n=!1,i=!1,o=!1;let r=document.getElementById("txt-numero"),a=document.getElementById("txt-fecha"),s=document.getElementById("txt-cvv"),l=document.getElementById("txt-nombre");this.numero=String(r.value),this.fecha=String(a.value),this.cvv=String(s.value),this.nombre=String(l.value);let c=this.servicioAES.set(this.keyJScrypto,this.numero.replace(/ /g,"")),g=this.servicioAES.set(this.keyJScrypto,this.fecha),u=this.servicioAES.set(this.keyJScrypto,this.cvv);if(0==this.nombre.length?(o=!1,this.presentToast("Debe ingresar el nombre del titular")):o=!0,console.log(this.cvv),3==this.cvv.length?i=!0:(i=!1,this.presentToast("Debe ingresar el n\xfamero de CVV")),console.log(this.fecha),5==this.fecha.length){let t=new Date;console.log(String(this.fecha).substring(3,5)),console.log(String(t.getMonth()+1)),Number(String(this.fecha).substring(0,2))<=12&&Number(String(this.fecha).substring(0,2))>0?Number(String(this.fecha).substring(3,5))==Number(String(t.getFullYear()).substring(2,4))?Number(String(this.fecha).substring(0,2))>Number(t.getMonth())+1?Number(String(this.fecha).substring(3,5))>=Number(String(t.getFullYear()).substring(2,4))&&Number(String(this.fecha).substring(3,5))<Number(String(t.getFullYear()).substring(2,4))+10?e=!0:(e=!1,this.presentToast("El A\xf1o de la fecha de vencimiento es incorrecto")):(e=!1,this.presentToast("El mes de la fecha de vencimiento es incorrecto")):Number(String(this.fecha).substring(3,5))>=Number(String(t.getFullYear()).substring(2,4))&&Number(String(this.fecha).substring(3,5))<Number(String(t.getFullYear()).substring(2,4))+10?e=!0:(e=!1,this.presentToast("El A\xf1o de la fecha de vencimiento es incorrecto")):(e=!1,this.presentToast("El mes de la fecha de vencimiento es incorrecto"))}else e=!1,this.presentToast("Debe ingresar la fecha de vencimiento");if(this.numero.length<19?(t=!1,this.presentToast("Debe ingresar un n\xfamero de tarjeta")):t=!0,0==this.tipo.length?(n=!1,this.presentToast("Debe ingresar un n\xfamero valido")):n=!0,1==t&&1==e&&1==n&&1==i&&1==o){const t=yield this.loadingCtrl.create();t.present(),this.apiService.getStorage("idusuario").then(e=>{"0"==this.miTarjeta?(this.tarjeta={idusuario:e,numero:c,titular:String(this.nombre),fecha:g,tipo:this.tipo,cvv:u},console.log(this.tarjeta),this.apiService.getTarjetas(e).subscribe(e=>{let n=e;if(console.log(n),null!=n){let e=0;for(let t of n)console.log(t),c==t.numero&&e++;console.log(e),0==e?this.apiService.insertarTarjeta(this.tarjeta).then(e=>{console.log(e),t.dismiss(),1===this.pantalla?(this.router.navigate(["mistarjetas"]),this.presentToast("Operaci\xf3n correcta")):this.location.back()}).catch(e=>{console.log(e),t.dismiss(),this.presentToast("No se puedo guardar su tarjeta intentelo de nuevo")}):(t.dismiss(),this.presentToast("Esta tarjeta ya esta guardada"))}else this.apiService.insertarTarjeta(this.tarjeta).then(e=>{console.log(e),t.dismiss(),1===this.pantalla?(this.router.navigate(["mistarjetas"]),this.presentToast("Operaci\xf3n correcta")):this.location.back()}).catch(e=>{console.log(e),t.dismiss(),this.presentToast("No se puedo guardar su tarjeta intentelo de nuevo")})})):(this.tarjeta={idusuario:e,numero:c,titular:String(this.nombre),fecha:g,tipo:this.tipo,idtarjeta:this.miTarjeta.idtarjeta,cvv:u},console.log(this.tarjeta),this.apiService.getTarjetas(e).subscribe(e=>{console.log(e),console.log(0),this.apiService.editarTarjeta(this.tarjeta).then(e=>{console.log("tarjeta editada"),console.log(e),t.dismiss(),1===this.pantalla?(this.router.navigate(["mistarjetas"]),this.presentToast("Operaci\xf3n correcta")):this.location.back()}).catch(e=>{console.log("error en editar tarjeta"),console.log(e),t.dismiss(),this.presentToast("No se puedo editar su tarjeta intentelo de nuevo")})},t=>{console.log(t)}))}).catch(e=>{console.log(e),t.dismiss(),this.presentToast("No se puedo guardar su tarjeta intentelo de nuevo")})}}))}presentToast(t){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.toastControler.create({message:t,duration:2e3,color:"danger"})).present()}))}regresar(){document.getElementById("volver4").disabled=!0}}return t.\u0275fac=function(e){return new(e||t)(l.Ib(r.sb),l.Ib(c.a),l.Ib(r.lb),l.Ib(r.ib),l.Ib(g.a),l.Ib(a.g),l.Ib(a.a),l.Ib(i.g))},t.\u0275cmp=l.Cb({type:t,selectors:[["app-agregar-tarjeta"]],decls:49,vars:12,consts:[["id","btnAtras","slot","start",2,"color","#f3f2ed"],["id","volver4",3,"click"],["oncopy","return false","onpaste","return false"],["id","cotenedor"],["src","./assets/Iconos/chip.png",1,"chip"],["id","tipo-tarjeta",3,"src"],["id","numero",1,"numero-tarjeta"],[1,"titulo-titular"],["id","titular","position","fixed",1,"titular"],[1,"titulo-fecha"],["id","fecha",1,"fecha"],["action","#"],[2,"background","#121212"],[2,"margin-top","20px","margin-left","20px"],["type","tel","inputmode","numeric","pattern","[0-9]","maxlength","19","id","txt-numero","placeholder","xxxx xxxx xxxx xxxx",3,"value","ionChange"],["name","card-outline"],[2,"margin-left","20px","margin-top","20px"],[2,"margin-left","55%","margin-top","-20px"],["id","txt-fecha","inputmode","numeric","placeholder","MM/YY","type","tel","pattern","[0-9]","maxlength","5",3,"value","ionChange"],["id","txt-cvv","inputmode","numeric","placeholder","CVV","type","tel","pattern","[0-9]","maxlength","3",3,"value","ionChange"],["name","help-circle-outline"],["id","txt-nombre","inputmode","text","placeholder","Apellido y Nombre","maxlength","30",3,"value","ionChange"],["name","person-outline"],["id","btn-agregar",3,"click"]],template:function(t,e){1&t&&(l.Mb(0,"ion-header"),l.Mb(1,"ion-toolbar"),l.Mb(2,"ion-buttons",0),l.Mb(3,"ion-back-button",1),l.Ub("click",(function(){return e.regresar()})),l.Lb(),l.Lb(),l.Mb(4,"ion-title"),l.uc(5,"M\xe9todo de pago"),l.Lb(),l.Lb(),l.Lb(),l.Mb(6,"ion-content",2),l.Mb(7,"h3"),l.uc(8,"A\xf1adir nueva tarjeta"),l.Lb(),l.Mb(9,"ion-item"),l.Mb(10,"div",3),l.Jb(11,"img",4),l.Jb(12,"img",5),l.Mb(13,"ion-label",6),l.uc(14),l.Lb(),l.Mb(15,"ion-label",7),l.uc(16,"Nombre titular"),l.Lb(),l.Mb(17,"ion-label",8),l.uc(18),l.Lb(),l.Mb(19,"ion-label",9),l.uc(20,"Fecha vencimiento"),l.Lb(),l.Mb(21,"ion-label",10),l.uc(22),l.Lb(),l.Lb(),l.Lb(),l.Mb(23,"form",11),l.Mb(24,"ion-list",12),l.Mb(25,"ion-row"),l.Mb(26,"ion-label",13),l.uc(27,"N\xfamero de tarjeta"),l.Lb(),l.Lb(),l.Mb(28,"ion-row"),l.Mb(29,"ion-input",14),l.Ub("ionChange",(function(t){return e.ponerNumero(t.target.value)})),l.Jb(30,"ion-icon",15),l.Lb(),l.Lb(),l.Mb(31,"ion-row"),l.Mb(32,"ion-label",16),l.uc(33,"Fecha Vencimiento"),l.Lb(),l.Mb(34,"ion-label",17),l.uc(35,"C\xf3digo de Seguridad"),l.Lb(),l.Lb(),l.Mb(36,"ion-row"),l.Mb(37,"ion-input",18),l.Ub("ionChange",(function(t){return e.ponerFecha(t.target.value)})),l.Lb(),l.Mb(38,"ion-input",19),l.Ub("ionChange",(function(t){return e.ponerCvv(t.target.value)})),l.Jb(39,"ion-icon",20),l.Lb(),l.Lb(),l.Mb(40,"ion-row"),l.Mb(41,"ion-label",13),l.uc(42,"Nombre del Titular"),l.Lb(),l.Lb(),l.Mb(43,"ion-row"),l.Mb(44,"ion-input",21),l.Ub("ionChange",(function(t){return e.ponerNombre(t.target.value)})),l.Jb(45,"ion-icon",22),l.Lb(),l.Lb(),l.Mb(46,"ion-row"),l.Mb(47,"ion-button",23),l.Ub("click",(function(){return e.insertarTarjeta()})),l.uc(48),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb()),2&t&&(l.yb(10),l.qc(e.miTarjeta.color),l.yb(2),l.gc("src","./assets/Iconos/",e.tipo,".png",l.nc),l.yb(2),l.vc(e.numero),l.yb(4),l.vc(e.nombre),l.yb(4),l.vc(e.fecha),l.yb(7),l.fc("value",e.miTarjeta.numero),l.yb(8),l.fc("value",e.miTarjeta.fecha),l.yb(1),l.fc("value",e.miTarjeta.cvv),l.yb(6),l.fc("value",e.miTarjeta.titular),l.yb(4),l.vc(e.nombreBoton))},directives:[r.v,r.fb,r.i,r.e,r.f,r.eb,r.q,r.B,r.G,o.o,o.i,o.j,r.H,r.Q,r.A,r.rb,r.w,r.h],styles:["ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:#108b3c}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:#fff;font-family:Gotham-Medium;font-size:23px}ion-content[_ngcontent-%COMP%]{--background:#121212}ion-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;right:10px;--color:#919291;width:20px;height:20px}ion-footer[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]{--background:#121212}ion-item[_ngcontent-%COMP%]{--border-color:#121212}h3[_ngcontent-%COMP%]{color:#f3f2ed;margin-top:30px;margin-left:20px;font-family:Gotham-Medium}div[_ngcontent-%COMP%]{background:#464545;border-radius:10px;width:100%;height:230px}.chip[_ngcontent-%COMP%]{width:70px;height:30px;position:absolute;left:10px;top:20px}#tipo-tarjeta[_ngcontent-%COMP%]{right:30px}#tipo-tarjeta[_ngcontent-%COMP%], #tipo-tarjeta2[_ngcontent-%COMP%]{width:40px;height:30px;position:absolute;top:10px}#tipo-tarjeta2[_ngcontent-%COMP%]{right:70px}.numero-tarjeta[_ngcontent-%COMP%]{font-family:Gotham-Medium;color:#fff;top:45%;font-size:28px;position:relative;text-align:center;align-items:center;align-content:center;margin:auto}.titular[_ngcontent-%COMP%]{font-size:16px;bottom:20px}.titular[_ngcontent-%COMP%], .titulo-titular[_ngcontent-%COMP%]{color:#fff;font-family:SFUIDisplay-Regular;position:absolute;left:20px}.titulo-titular[_ngcontent-%COMP%]{font-size:14px;bottom:40px}.fecha[_ngcontent-%COMP%]{font-size:16px;right:50px;bottom:20px}.fecha[_ngcontent-%COMP%], .titulo-fecha[_ngcontent-%COMP%]{color:#fff;font-family:SFUIDisplay-Regular;position:absolute}.titulo-fecha[_ngcontent-%COMP%]{font-size:14px;right:30px;bottom:40px}ion-input[_ngcontent-%COMP%]{height:50px;color:#121212;--background:#fff;border-radius:10px;font-size:20px;--padding-left:10px;--padding-right:10px}#txt-nombre[_ngcontent-%COMP%], #txt-numero[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px;margin-top:10px}#txt-fecha[_ngcontent-%COMP%]{margin-left:20px;margin-right:5px}#txt-cvv[_ngcontent-%COMP%], #txt-fecha[_ngcontent-%COMP%]{width:10px;margin-top:10px}#txt-cvv[_ngcontent-%COMP%]{margin-right:20px;margin-left:5px}#btn-agregar[_ngcontent-%COMP%]{width:90%;--background:#108b3c;--border-radius:10px;margin-left:5%;margin-right:5%;margin-top:20px;color:#fff;height:50px;border-radius:50x}ion-row[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#fff}"]}),t})()}];let h=(()=>{class t{}return t.\u0275mod=l.Gb({type:t}),t.\u0275inj=l.Fb({factory:function(e){return new(e||t)},imports:[[a.i.forChild(u)],a.i]}),t})(),b=(()=>{class t{}return t.\u0275mod=l.Gb({type:t}),t.\u0275inj=l.Fb({factory:function(e){return new(e||t)},providers:[g.a],imports:[[i.c,o.d,r.gb,h]]}),t})()}}]);