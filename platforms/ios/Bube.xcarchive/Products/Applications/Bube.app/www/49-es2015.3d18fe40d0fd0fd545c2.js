(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{CiRT:function(t,e,i){"use strict";i.r(e),i.d(e,"ValidacionFechaNacimientoPageModule",(function(){return h}));var n=i("ofXK"),o=i("3Pt+"),r=i("TEn/"),a=i("mrSG"),s=i("wd/R"),c=i("fXoL"),l=i("tyNb"),d=i("CmMg");const g=[{path:"",component:(()=>{class t{constructor(t,e,i,n,o){this.route=t,this.router=e,this.loadingController=i,this.apiService=n,this.alertController=o,this.botonContinuar=!0,this.options={buttons:[{text:"Cancelar",role:"cancel"},{text:"Ok",role:"Done",handler:t=>{console.log(t),this.fechaNacimiento=String(t.month.text)+"-"+String(t.day.text)+"-"+String(t.year.text),this.nuevoUsuario.fechaNacimiento=this.convert(this.fechaNacimiento),console.log(this.convert(this.fechaNacimiento)),this.validarFechaNacimiento()}}]},this.route.queryParams.subscribe(t=>{this.router.getCurrentNavigation().extras.state&&(this.nuevoUsuario=this.router.getCurrentNavigation().extras.state.nuevoUsuario,this.tipoRegistro=this.router.getCurrentNavigation().extras.state.tipoRegistro,this.amigo=this.router.getCurrentNavigation().extras.state.amigo,this.validarFechaNacimiento())})}ngOnInit(){}validarFechaNacimiento(){null==this.nuevoUsuario.fechaNacimiento||null==this.nuevoUsuario.fechaNacimiento||""==this.nuevoUsuario.fechaNacimiento?(this.botonContinuar=!0,this.fechaNacimiento=this.nuevoUsuario.fechaNacimiento):this.botonContinuar=!1}validarMayorEdad(){let t=new Date;var e=Date.parse(this.fechaNacimiento+" 00:00:00");let i=new Date(e);return!(t.getFullYear()-i.getFullYear()<18)}irValidacionBebidas(){if(this.validarMayorEdad()){this.presentLoading(),console.log(this.nuevoUsuario);let t={id:this.nuevoUsuario.id,email:this.nuevoUsuario.email,first_name:this.nuevoUsuario.nombreCompleto,picture:{data:{url:this.nuevoUsuario.rutaFoto}},last_name:this.nuevoUsuario.apellidos,gender:this.nuevoUsuario.genero,birthday:this.nuevoUsuario.fechaNacimiento,password:this.nuevoUsuario.password,telefono:this.nuevoUsuario.telefono,viene_de:this.tipoRegistro,idapple:this.nuevoUsuario.idapple};console.log(t),this.validarTipoRegistro(t)}else this.presentAlert1()}validarTipoRegistro(t){"email"==this.tipoRegistro||"tel"==this.tipoRegistro?this.insertaUser(t):"fb"==this.tipoRegistro?this.insertaUserFB(t):"apple"==this.tipoRegistro?this.insertaUserApple(t):console.log("ERROR EN TIPO DE REGISTRO")}insertaUser(t){this.apiService.postRegistrarLoginGmail(t).then(t=>{console.log("retorno api "+JSON.stringify(t)),this.guardarIdUser(t),this.irValidacionInicio()}).catch(t=>{this.loading.dismiss(),this.presentAlert3(t)})}insertaUserApple(t){this.apiService.postRegistrarLoginApple(t).then(t=>{console.log("retorno api "+JSON.stringify(t)),this.guardarIdUser(t),this.irValidacionInicio()}).catch(t=>{this.loading.dismiss(),this.presentAlert3(t)})}insertaUserFB(t){this.apiService.guardarUsuario(t).then(t=>{this.guardarIdUser(t),this.insertarAmigos(t)}).catch(t=>{this.loading.dismiss(),this.presentAlert3(t)})}insertarAmigos(t){let e=this.retornarid(t),i={idusuario:e,listaamigos:JSON.stringify(this.amigo.data)};this.apiService.guardarAmigos({idusuario:e,listaamigos:i.listaamigos}).then(t=>{console.log("inserto amigos "+JSON.stringify(t)),this.irValidacionInicio()}).catch(t=>{console.log("error insertar amigo "+t),this.loading.dismiss(),this.presentAlert4()})}irValidacionInicio(){this.loading.dismiss(),this.router.navigate(["./validacionInicio",1],{state:{nuevoUsuario:this.nuevoUsuario,tipoRegistro:this.tipoRegistro}})}guardarIdUser(t){let e=this.nuevoUsuario.email,i=this.retornarid(t),n=this.retornarFlag(t);this.apiService.setStorage("idusuario",i),this.apiService.setStorage("ind_user",n),this.apiService.setStorage("correo",e),this.apiService.setStorage("usuario",this.nuevoUsuario),this.apiService.setStorage("tipoRegistro",this.tipoRegistro)}retornarFlag(t){let e,i=[];return i=t,i.find(t=>{e=t.ind_user}),e}retornarid(t){let e,i=[];return i=t,i.find(t=>{e=t.idusuario}),e}convert(t){return s(t).format("DD/MM/YYYY")}presentLoading(){return Object(a.a)(this,void 0,void 0,(function*(){this.loading=yield this.loadingController.create({cssClass:"my-custom-class",message:"Iniciando sesi\xf3n"}),yield this.loading.present()}))}presentAlert1(){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.alertController.create({header:"Menor de edad",cssClass:"my-custom-class",message:"Debes ser mayor de edad (18+)",buttons:["OK"]});yield t.present()}))}presentAlert3(t){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({header:"Error",subHeader:"Error al registrar usuario",message:t,buttons:["OK"]});yield e.present()}))}presentAlert4(){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.alertController.create({header:"Error",subHeader:"Error al insertar amigos",message:"Intente m\xe1s tarde",buttons:["OK"]});yield t.present()}))}}return t.\u0275fac=function(e){return new(e||t)(c.Ib(l.a),c.Ib(l.g),c.Ib(r.ib),c.Ib(d.a),c.Ib(r.a))},t.\u0275cmp=c.Cb({type:t,selectors:[["app-validacion-fecha-nacimiento"]],decls:18,vars:3,consts:[[1,"conteiner-titulo"],[1,"titulo-login"],[1,"container-date"],["lines","none"],["placeholder","Seleccione",1,"date-time",3,"ngModel","pickerOptions","ngModelChange"],[1,"contenedor"],[1,"btn-inicio-sesion",3,"disabled","click"],[1,"contenedor-edad"],[1,"text-edad"]],template:function(t,e){1&t&&(c.Jb(0,"ion-header"),c.Mb(1,"ion-content"),c.Mb(2,"ion-row"),c.Mb(3,"div",0),c.Mb(4,"ion-label",1),c.uc(5,"Ingresa tu fecha de cumplea\xf1os"),c.Jb(6,"br"),c.Lb(),c.Lb(),c.Lb(),c.Mb(7,"ion-row"),c.Mb(8,"div",2),c.Mb(9,"ion-item",3),c.Mb(10,"ion-datetime",4),c.Ub("ngModelChange",(function(t){return e.fechaNacimiento=t})),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Mb(11,"ion-row"),c.Mb(12,"div",5),c.Mb(13,"ion-button",6),c.Ub("click",(function(){return e.irValidacionBebidas()})),c.uc(14,"Continuar"),c.Lb(),c.Lb(),c.Mb(15,"div",7),c.Mb(16,"ion-label",8),c.uc(17,"Debe ser 18+"),c.Lb(),c.Lb(),c.Lb(),c.Lb()),2&t&&(c.yb(10),c.ec("ngModel",e.fechaNacimiento)("pickerOptions",e.options),c.yb(3),c.ec("disabled",e.botonContinuar))},directives:[r.v,r.q,r.Q,r.G,r.B,r.r,r.qb,o.h,o.k,r.h],styles:["ion-content[_ngcontent-%COMP%]{--background:#121212}ion-content[_ngcontent-%COMP%]   .conteiner-titulo[_ngcontent-%COMP%]{text-align:center;align-content:center;left:0;right:0;margin-top:40%;width:100%;margin-bottom:20px}ion-content[_ngcontent-%COMP%]   .conteiner-titulo[_ngcontent-%COMP%]   .titulo-login[_ngcontent-%COMP%]{color:#f3f2ed;font-family:SF-UI-Display-Black;font-size:20px;margin-top:20px}ion-content[_ngcontent-%COMP%]   .container-date[_ngcontent-%COMP%]{width:100%;text-align:center;justify-content:center}ion-content[_ngcontent-%COMP%]   .container-date[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin:auto;--border-color:#108b3c;--background:#121212!important;--border-width:1px 0px 1px 0px;width:45%}ion-content[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]{margin:auto}ion-content[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]::part(placeholder), ion-content[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]::part(text){color:#f3f2ed!important;font-family:SF-UI-Display-Black!important}ion-content[_ngcontent-%COMP%]   .date-time[_ngcontent-%COMP%]::part(placeholder){text-align:center}ion-content[_ngcontent-%COMP%]   .contenedor[_ngcontent-%COMP%]{margin-top:100px;align-content:center;text-align:center;width:100%}ion-content[_ngcontent-%COMP%]   .contenedor[_ngcontent-%COMP%]   .btn-inicio-sesion[_ngcontent-%COMP%]{--background:#121212;margin-left:30px;margin-right:30px;margin-bottom:20px;font-size:16px;height:50px;width:200px;text-transform:none;--border-color:#108b3c;--border-style:solid;--border-width:2px;font-family:SFUIDisplay-Regular;--border-radius:25px;letter-spacing:.25px;--background-activated:#383838}ion-content[_ngcontent-%COMP%]   .contenedor-edad[_ngcontent-%COMP%]{align-content:center;text-align:center;width:100%}ion-content[_ngcontent-%COMP%]   .contenedor-edad[_ngcontent-%COMP%]   .text-edad[_ngcontent-%COMP%]{color:#f3f2ed!important;font-family:SFUIDisplay-Regular;letter-spacing:.25px}"]}),t})()}];let h=(()=>{class t{}return t.\u0275mod=c.Gb({type:t}),t.\u0275inj=c.Fb({factory:function(e){return new(e||t)},imports:[[n.c,o.d,r.gb,l.i.forChild(g)]]}),t})()}}]);