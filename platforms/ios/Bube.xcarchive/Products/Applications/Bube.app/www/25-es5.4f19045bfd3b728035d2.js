!function(){function t(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{yOQ9:function(e,o,i){"use strict";i.r(o),i.d(o,"AgregarTarjetaPageModule",(function(){return x}));var a,s,c,l=i("ofXK"),u=i("3Pt+"),g=i("TEn/"),b=i("tyNb"),h=i("mrSG"),m=i("fXoL"),p=i("CmMg"),f=i("Q4mC"),d=[{path:"",component:(a=function(){function e(t,r,o,i,a,s,c,l){var u=this;n(this,e),this.toastControler=t,this.apiService=r,this.navCtrl=o,this.loadingCtrl=i,this.servicioAES=a,this.router=s,this.route=c,this.location=l,this.nombre="",this.name="",this.apellido="",this.numero="N\xfamero de tarjeta",this.fecha="",this.cvv="",this.tipo="hola",this.tarjeta={},this.ocultar=!0,this.keyJScrypto="123456$#@$^@1ERF",this.route.queryParams.subscribe((function(t){u.router.getCurrentNavigation().extras.state&&(u.miTarjeta=u.router.getCurrentNavigation().extras.state.tarjeta,u.pantalla=u.router.getCurrentNavigation().extras.state.pantalla,console.log(u.pantalla))}))}var o,i,a;return o=e,(i=[{key:"ngOnInit",value:function(){}},{key:"ionViewWillEnter",value:function(){console.log(this.miTarjeta),"0"==this.miTarjeta?(this.nombreBoton="A\xf1adir tarjeta",this.fecha=" "):(this.nombreBoton="Editar tarjeta",this.ponerNumeroEditar(this.miTarjeta.numero),this.ponerNombre(this.miTarjeta.titular),this.ponerFecha(this.miTarjeta.fecha),this.ponerCvv(this.miTarjeta.cvv))}},{key:"ponerNumeroEditar",value:function(t){var e=document.getElementById("txt-numero"),n=String(t).substring(0,4)+" "+String(t).substring(4,8)+" "+String(t).substring(8,12)+" "+String(t).substring(12,16);e.value=n,console.log("numero editar"),console.log(t),this.numero=n}},{key:"ponerNumero",value:function(t){if(null!=t){console.log(t),console.log(String(t).replace(/ /g,""));var e=document.getElementById("txt-numero"),n=document.getElementById("tipo-tarjeta"),r=document.getElementById("cotenedor"),o=String(t);console.log(o.substring(0,1)),"4"==o.substring(0,1)?(console.log("visa"),n.style.display="block",e.style.color="#000",r.style.background="#1c3a24",this.tipo="visa",this.arreglarNumero(t)):"5"==o.substring(0,1)&&(console.log("mastercard"),n.style.display="block",e.style.color="#000",r.style.background="#464545",this.tipo="master",this.arreglarNumero(t))}else console.log("numero vacio")}},{key:"arreglarNumero",value:function(t){var e=document.getElementById("txt-numero");if(" "===String(t).substring(4)&&5==String(t).length)e.value=t,this.numero=t;else if(5==String(t).length){var n=String(t).substring(0,4)+" "+String(t).substring(4);e.value=n,this.numero=n}if(" "===String(t).substring(9)&&10==String(t).length)e.value=t,this.numero=t;else if(10==String(t).length){var r=String(t).substring(0,9)+" "+String(t).substring(9);e.value=r,this.numero=r}if(" "===String(t).substring(14)&&15==String(t).length)e.value=t,this.numero=t;else if(15==String(t).length){var o=String(t).substring(0,14)+" "+String(t).substring(14);e.value=o,this.numero=o}else this.numero=t}},{key:"ponerNombre",value:function(t){null!=t?this.nombre=String(t):console.log("nombre vacio")}},{key:"ponerCvv",value:function(t){this.cvv=String(t)}},{key:"ponerFecha",value:function(t){var e=document.getElementById("txt-fecha");"/"===String(t).substring(2)&&3==String(t).length?e.value=t:3==String(t).length&&(e.value=String(t).substring(0,2)+"/"+String(t).substring(2)),console.log(String(t).substring(2)),this.fecha=String(t)}},{key:"insertarTarjeta",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,o,i,a,s,c,l,u,g,b,h,m,p,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,r=!1,o=!1,i=!1,a=!1,s=document.getElementById("txt-numero"),c=document.getElementById("txt-fecha"),l=document.getElementById("txt-cvv"),u=document.getElementById("txt-nombre"),this.numero=String(s.value),this.fecha=String(c.value),this.cvv=String(l.value),this.nombre=String(u.value),g=this.servicioAES.set(this.keyJScrypto,this.numero.replace(/ /g,"")),b=this.servicioAES.set(this.keyJScrypto,this.fecha),h=this.servicioAES.set(this.keyJScrypto,this.cvv),0==this.nombre.length?(a=!1,this.presentToast("Debe ingresar el nombre del titular")):a=!0,console.log(this.cvv),3==this.cvv.length?i=!0:(i=!1,this.presentToast("Debe ingresar el n\xfamero de CVV")),console.log(this.fecha),5==this.fecha.length?(m=new Date,console.log(String(this.fecha).substring(3,5)),console.log(String(m.getMonth()+1)),Number(String(this.fecha).substring(0,2))<=12&&Number(String(this.fecha).substring(0,2))>0?Number(String(this.fecha).substring(3,5))==Number(String(m.getFullYear()).substring(2,4))?Number(String(this.fecha).substring(0,2))>Number(m.getMonth())+1?Number(String(this.fecha).substring(3,5))>=Number(String(m.getFullYear()).substring(2,4))&&Number(String(this.fecha).substring(3,5))<Number(String(m.getFullYear()).substring(2,4))+10?r=!0:(r=!1,this.presentToast("El A\xf1o de la fecha de vencimiento es incorrecto")):(r=!1,this.presentToast("El mes de la fecha de vencimiento es incorrecto")):Number(String(this.fecha).substring(3,5))>=Number(String(m.getFullYear()).substring(2,4))&&Number(String(this.fecha).substring(3,5))<Number(String(m.getFullYear()).substring(2,4))+10?r=!0:(r=!1,this.presentToast("El A\xf1o de la fecha de vencimiento es incorrecto")):(r=!1,this.presentToast("El mes de la fecha de vencimiento es incorrecto"))):(r=!1,this.presentToast("Debe ingresar la fecha de vencimiento")),this.numero.length<19?(n=!1,this.presentToast("Debe ingresar un n\xfamero de tarjeta")):n=!0,0==this.tipo.length?(o=!1,this.presentToast("Debe ingresar un n\xfamero valido")):o=!0,1!=n||1!=r||1!=o||1!=i||1!=a){e.next=10;break}return e.next=8,this.loadingCtrl.create();case 8:(p=e.sent).present(),this.apiService.getStorage("idusuario").then((function(e){"0"==f.miTarjeta?(f.tarjeta={idusuario:e,numero:g,titular:String(f.nombre),fecha:b,tipo:f.tipo,cvv:h},console.log(f.tarjeta),f.apiService.getTarjetas(e).subscribe((function(e){var n=e;if(console.log(n),null!=n){var r,o=0,i=t(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;console.log(a),g==a.numero&&o++}}catch(s){i.e(s)}finally{i.f()}console.log(o),0==o?f.apiService.insertarTarjeta(f.tarjeta).then((function(t){console.log(t),p.dismiss(),1===f.pantalla?(f.router.navigate(["mistarjetas"]),f.presentToast("Operaci\xf3n correcta")):f.location.back()})).catch((function(t){console.log(t),p.dismiss(),f.presentToast("No se puedo guardar su tarjeta intentelo de nuevo")})):(p.dismiss(),f.presentToast("Esta tarjeta ya esta guardada"))}else f.apiService.insertarTarjeta(f.tarjeta).then((function(t){console.log(t),p.dismiss(),1===f.pantalla?(f.router.navigate(["mistarjetas"]),f.presentToast("Operaci\xf3n correcta")):f.location.back()})).catch((function(t){console.log(t),p.dismiss(),f.presentToast("No se puedo guardar su tarjeta intentelo de nuevo")}))}))):(f.tarjeta={idusuario:e,numero:g,titular:String(f.nombre),fecha:b,tipo:f.tipo,idtarjeta:f.miTarjeta.idtarjeta,cvv:h},console.log(f.tarjeta),f.apiService.getTarjetas(e).subscribe((function(t){console.log(t),console.log(0),f.apiService.editarTarjeta(f.tarjeta).then((function(t){console.log("tarjeta editada"),console.log(t),p.dismiss(),1===f.pantalla?(f.router.navigate(["mistarjetas"]),f.presentToast("Operaci\xf3n correcta")):f.location.back()})).catch((function(t){console.log("error en editar tarjeta"),console.log(t),p.dismiss(),f.presentToast("No se puedo editar su tarjeta intentelo de nuevo")}))}),(function(t){console.log(t)})))})).catch((function(t){console.log(t),p.dismiss(),f.presentToast("No se puedo guardar su tarjeta intentelo de nuevo")}));case 10:case"end":return e.stop()}}),e,this)})))}},{key:"presentToast",value:function(t){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastControler.create({message:t,duration:2e3,color:"danger"});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"regresar",value:function(){document.getElementById("volver4").disabled=!0}}])&&r(o.prototype,i),a&&r(o,a),e}(),a.\u0275fac=function(t){return new(t||a)(m.Ib(g.sb),m.Ib(p.a),m.Ib(g.lb),m.Ib(g.ib),m.Ib(f.a),m.Ib(b.g),m.Ib(b.a),m.Ib(l.g))},a.\u0275cmp=m.Cb({type:a,selectors:[["app-agregar-tarjeta"]],decls:49,vars:12,consts:[["id","btnAtras","slot","start",2,"color","#f3f2ed"],["id","volver4",3,"click"],["oncopy","return false","onpaste","return false"],["id","cotenedor"],["src","./assets/Iconos/chip.png",1,"chip"],["id","tipo-tarjeta",3,"src"],["id","numero",1,"numero-tarjeta"],[1,"titulo-titular"],["id","titular","position","fixed",1,"titular"],[1,"titulo-fecha"],["id","fecha",1,"fecha"],["action","#"],[2,"background","#121212"],[2,"margin-top","20px","margin-left","20px"],["type","tel","inputmode","numeric","pattern","[0-9]","maxlength","19","id","txt-numero","placeholder","xxxx xxxx xxxx xxxx",3,"value","ionChange"],["name","card-outline"],[2,"margin-left","20px","margin-top","20px"],[2,"margin-left","55%","margin-top","-20px"],["id","txt-fecha","inputmode","numeric","placeholder","MM/YY","type","tel","pattern","[0-9]","maxlength","5",3,"value","ionChange"],["id","txt-cvv","inputmode","numeric","placeholder","CVV","type","tel","pattern","[0-9]","maxlength","3",3,"value","ionChange"],["name","help-circle-outline"],["id","txt-nombre","inputmode","text","placeholder","Apellido y Nombre","maxlength","30",3,"value","ionChange"],["name","person-outline"],["id","btn-agregar",3,"click"]],template:function(t,e){1&t&&(m.Mb(0,"ion-header"),m.Mb(1,"ion-toolbar"),m.Mb(2,"ion-buttons",0),m.Mb(3,"ion-back-button",1),m.Ub("click",(function(){return e.regresar()})),m.Lb(),m.Lb(),m.Mb(4,"ion-title"),m.uc(5,"M\xe9todo de pago"),m.Lb(),m.Lb(),m.Lb(),m.Mb(6,"ion-content",2),m.Mb(7,"h3"),m.uc(8,"A\xf1adir nueva tarjeta"),m.Lb(),m.Mb(9,"ion-item"),m.Mb(10,"div",3),m.Jb(11,"img",4),m.Jb(12,"img",5),m.Mb(13,"ion-label",6),m.uc(14),m.Lb(),m.Mb(15,"ion-label",7),m.uc(16,"Nombre titular"),m.Lb(),m.Mb(17,"ion-label",8),m.uc(18),m.Lb(),m.Mb(19,"ion-label",9),m.uc(20,"Fecha vencimiento"),m.Lb(),m.Mb(21,"ion-label",10),m.uc(22),m.Lb(),m.Lb(),m.Lb(),m.Mb(23,"form",11),m.Mb(24,"ion-list",12),m.Mb(25,"ion-row"),m.Mb(26,"ion-label",13),m.uc(27,"N\xfamero de tarjeta"),m.Lb(),m.Lb(),m.Mb(28,"ion-row"),m.Mb(29,"ion-input",14),m.Ub("ionChange",(function(t){return e.ponerNumero(t.target.value)})),m.Jb(30,"ion-icon",15),m.Lb(),m.Lb(),m.Mb(31,"ion-row"),m.Mb(32,"ion-label",16),m.uc(33,"Fecha Vencimiento"),m.Lb(),m.Mb(34,"ion-label",17),m.uc(35,"C\xf3digo de Seguridad"),m.Lb(),m.Lb(),m.Mb(36,"ion-row"),m.Mb(37,"ion-input",18),m.Ub("ionChange",(function(t){return e.ponerFecha(t.target.value)})),m.Lb(),m.Mb(38,"ion-input",19),m.Ub("ionChange",(function(t){return e.ponerCvv(t.target.value)})),m.Jb(39,"ion-icon",20),m.Lb(),m.Lb(),m.Mb(40,"ion-row"),m.Mb(41,"ion-label",13),m.uc(42,"Nombre del Titular"),m.Lb(),m.Lb(),m.Mb(43,"ion-row"),m.Mb(44,"ion-input",21),m.Ub("ionChange",(function(t){return e.ponerNombre(t.target.value)})),m.Jb(45,"ion-icon",22),m.Lb(),m.Lb(),m.Mb(46,"ion-row"),m.Mb(47,"ion-button",23),m.Ub("click",(function(){return e.insertarTarjeta()})),m.uc(48),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb()),2&t&&(m.yb(10),m.qc(e.miTarjeta.color),m.yb(2),m.gc("src","./assets/Iconos/",e.tipo,".png",m.nc),m.yb(2),m.vc(e.numero),m.yb(4),m.vc(e.nombre),m.yb(4),m.vc(e.fecha),m.yb(7),m.fc("value",e.miTarjeta.numero),m.yb(8),m.fc("value",e.miTarjeta.fecha),m.yb(1),m.fc("value",e.miTarjeta.cvv),m.yb(6),m.fc("value",e.miTarjeta.titular),m.yb(4),m.vc(e.nombreBoton))},directives:[g.v,g.fb,g.i,g.e,g.f,g.eb,g.q,g.B,g.G,u.o,u.i,u.j,g.H,g.Q,g.A,g.rb,g.w,g.h],styles:["ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:#108b3c}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:#fff;font-family:Gotham-Medium;font-size:23px}ion-content[_ngcontent-%COMP%]{--background:#121212}ion-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;right:10px;--color:#919291;width:20px;height:20px}ion-footer[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]{--background:#121212}ion-item[_ngcontent-%COMP%]{--border-color:#121212}h3[_ngcontent-%COMP%]{color:#f3f2ed;margin-top:30px;margin-left:20px;font-family:Gotham-Medium}div[_ngcontent-%COMP%]{background:#464545;border-radius:10px;width:100%;height:230px}.chip[_ngcontent-%COMP%]{width:70px;height:30px;position:absolute;left:10px;top:20px}#tipo-tarjeta[_ngcontent-%COMP%]{right:30px}#tipo-tarjeta[_ngcontent-%COMP%], #tipo-tarjeta2[_ngcontent-%COMP%]{width:40px;height:30px;position:absolute;top:10px}#tipo-tarjeta2[_ngcontent-%COMP%]{right:70px}.numero-tarjeta[_ngcontent-%COMP%]{font-family:Gotham-Medium;color:#fff;top:45%;font-size:28px;position:relative;text-align:center;align-items:center;align-content:center;margin:auto}.titular[_ngcontent-%COMP%]{font-size:16px;bottom:20px}.titular[_ngcontent-%COMP%], .titulo-titular[_ngcontent-%COMP%]{color:#fff;font-family:SFUIDisplay-Regular;position:absolute;left:20px}.titulo-titular[_ngcontent-%COMP%]{font-size:14px;bottom:40px}.fecha[_ngcontent-%COMP%]{font-size:16px;right:50px;bottom:20px}.fecha[_ngcontent-%COMP%], .titulo-fecha[_ngcontent-%COMP%]{color:#fff;font-family:SFUIDisplay-Regular;position:absolute}.titulo-fecha[_ngcontent-%COMP%]{font-size:14px;right:30px;bottom:40px}ion-input[_ngcontent-%COMP%]{height:50px;color:#121212;--background:#fff;border-radius:10px;font-size:20px;--padding-left:10px;--padding-right:10px}#txt-nombre[_ngcontent-%COMP%], #txt-numero[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px;margin-top:10px}#txt-fecha[_ngcontent-%COMP%]{margin-left:20px;margin-right:5px}#txt-cvv[_ngcontent-%COMP%], #txt-fecha[_ngcontent-%COMP%]{width:10px;margin-top:10px}#txt-cvv[_ngcontent-%COMP%]{margin-right:20px;margin-left:5px}#btn-agregar[_ngcontent-%COMP%]{width:90%;--background:#108b3c;--border-radius:10px;margin-left:5%;margin-right:5%;margin-top:20px;color:#fff;height:50px;border-radius:50x}ion-row[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#fff}"]}),a)}],v=((c=function t(){n(this,t)}).\u0275mod=m.Gb({type:c}),c.\u0275inj=m.Fb({factory:function(t){return new(t||c)},imports:[[b.i.forChild(d)],b.i]}),c),x=((s=function t(){n(this,t)}).\u0275mod=m.Gb({type:s}),s.\u0275inj=m.Fb({factory:function(t){return new(t||s)},providers:[f.a],imports:[[l.c,u.d,g.gb,v]]}),s)}}])}();