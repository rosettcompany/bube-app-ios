(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{X3zk:function(e,t,i){"use strict";i.r(t),i.d(t,"LoginPageModule",(function(){return x}));var o=i("ofXK"),n=i("TEn/"),r=i("3Pt+"),s=i("tyNb"),a=i("mrSG"),l=i("3EM6"),c=i("fXoL"),p=i("GGTb"),g=i("CmMg"),u=i("54vc"),d=i("up+p"),b=i("xS7M"),h=i("e8h1");function m(e,t){1&e&&c.Jb(0,"ion-spinner",18)}function f(e,t){if(1&e){const e=c.Nb();c.Mb(0,"div",7),c.Mb(1,"ion-button",15),c.Ub("click",(function(){return c.mc(e),c.Xb().cargarLoginApple()})),c.Jb(2,"ion-icon",16),c.Mb(3,"ion-label",10),c.uc(4,"Iniciar sesi\xf3n con Apple"),c.Lb(),c.sc(5,m,1,0,"ion-spinner",17),c.Lb(),c.Lb()}if(2&e){const e=c.Xb();c.yb(1),c.ec("disabled",e.botonApple),c.yb(4),c.ec("ngIf",e.botonApple)}}const v=[{path:"",component:(()=>{class e{constructor(e,t,i,o,n,r,s,a,l,c,p,g){this.router=e,this.facebook=t,this.menu=i,this.apiService=o,this.splashScreen=n,this.platform=r,this.googlePlus=s,this.loadingController=a,this.alertController=l,this.device=c,this.signInWithApple=p,this.storage=g,this.user={},this.respuesta={},this.amigo={},this.idUsuarioLista=[],this.showSingApple=!1,this.botonApple=!1,this.Usuario={id:"",nombreCompleto:"",apellidos:"",telefono:"0",email:"",rutaFoto:"",fechaNacimiento:"",genero:"",password:"",idapple:""},"iOS"==String(this.device.platform)&&Number(String(this.device.version).substring(0,2))>=13&&(this.showSingApple=!0)}ionViewDidEnter(){this.menu.enable(!1),this.splashScreen.hide()}ionViewDidLeave(){this.menu.enable(!0)}presentLoading(){return Object(a.a)(this,void 0,void 0,(function*(){this.loading=yield this.loadingController.create({cssClass:"my-custom-class",message:"Iniciando sesi\xf3n"}),yield this.loading.present()}))}presentAlertSinConexion(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Sin Conexi\xf3n",message:"Intente m\xe1s tarde",buttons:["OK"]});yield e.present()}))}presentAlert1(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al obtener datos",message:"Intente m\xe1s tarde",buttons:["OK"]});yield e.present()}))}presentAlert2(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al obtener amigos",message:"Intente m\xe1s tarde",buttons:["OK"]});yield e.present()}))}presentAlert3(e){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al registrar usuario",message:e,buttons:["OK"]});yield t.present()}))}presentAlert4(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Error",subHeader:"Error al insertar amigos",message:"Intente m\xe1s tarde",buttons:["OK"]});yield e.present()}))}terminosYcondiciones(){console.log("terminos y condiciones"),this.router.navigate(["./terminos",1])}loginFacebook(){this.logoutGmail(),this.presentLoading(),this.facebook.login(["public_profile","user_friends","email"]).then(e=>{console.log(e.status),"connected"==e.status&&this.getInfo()}).catch(e=>{this.loading.dismiss(),this.presentAlertSinConexion(),console.error(e)})}getInfo(){this.facebook.api("/me?fields=id,email,first_name,picture.type(large),last_name,gender,birthday",[]).then(e=>{console.log(e),this.user=e,this.Usuario.id=e.id,this.Usuario.email=null==e.email?"":e.email,this.Usuario.nombreCompleto=e.first_name,this.Usuario.apellidos=null==e.last_name?"":e.last_name,this.Usuario.genero=null==e.gender?"":e.gender,this.Usuario.rutaFoto=null==e.picture.data.url?"":e.picture.data.url,this.Usuario.fechaNacimiento=null==e.birthday?"":e.birthday,this.getFriends()}).catch(e=>{console.error(e),this.loading.dismiss(),this.presentAlert1()})}getFriends(){this.facebook.api("/me/friends?fields=uid,name,picture.type(large)",[]).then(e=>{console.log(e),this.amigo=e,this.verificarUsuarioFB({id:this.Usuario.id})}).catch(e=>{console.error(e),this.loading.dismiss(),this.presentAlert2()})}verificarUsuarioFB(e){this.apiService.verificarUsuarioFB(e).then(e=>{this.loading.dismiss(),this.logearse(e,"fb")}).catch(e=>{console.log(e)})}guardarIdUser(e,t){let i=this.user.email,o=this.retornarid(e),n=this.retornarFlag(e);this.apiService.setStorage("idusuario",o),this.apiService.setStorage("ind_user",n),this.apiService.setStorage("correo",i),this.apiService.setStorage("usuario",this.Usuario),this.apiService.setStorage("tipoRegistro",t)}retornarFlag(e){let t,i=[];return i=e,i.find(e=>{t=e.ind_user}),t}retornarid(e){let t,i=[];return i=e,i.find(e=>{t=e.idusuario}),t}logearse(e,t){var i=this.retornarFlag(e);console.log("ind logearse "+i);let o={state:{nuevoUsuario:this.Usuario,amigo:this.amigo,tipoRegistro:t}};0==i?(console.log("usuario no existe"),this.router.navigate(["validacion-fecha-nacimiento"],o)):(this.guardarIdUser(e,t),3==i?(console.log("usuario nuevo"),this.router.navigate(["./validacionInicio",1],o)):4==i?(console.log("usuario nuevo"),this.router.navigate(["./validacionCorreo"],o)):2==i&&(console.log("usuario antiguo"),this.router.navigate(["./app/inicio"],o)))}irOtrosInicios(){this.router.navigate(["login-elige-sesion"])}logoutGmail(){this.googlePlus.logout()}cargarLoginApple(){this.botonApple=!0,this.eventoLoginApple()}eventoLoginApple(){this.apiService.getStorage("apple_activo").then(e=>{this.loginApple()}).catch(e=>{console.log(e),this.loginApple()})}loginApple(){this.signInWithApple.signin({requestedScopes:[l.a.ASAuthorizationScopeFullName,l.a.ASAuthorizationScopeEmail]}).then(e=>{console.log(e),this.apiService.setStorage("apple_activo",1),this.Usuario.nombreCompleto=""==e.fullName.givenName||null==e.fullName.givenName?"":e.fullName.givenName,this.Usuario.apellidos=""==e.fullName.familyName||null==e.fullName.familyName?"":e.fullName.familyName,this.Usuario.email=""==e.email||null==e.email?"":e.email,this.Usuario.rutaFoto="https://firebasestorage.googleapis.com/v0/b/bubeapp.appspot.com/o/ImagenesUsuarios%2Favatar_perfil.jpg?alt=media&token=3757e499-3ff4-4f3a-ba3d-911bde3506f7",this.Usuario.idapple=""==e.user||null==e.user?"":e.user,this.user.email=this.Usuario.email;let t={idapple:this.Usuario.idapple};""==this.Usuario.idapple?this.botonApple=!1:this.postVerificarLoginApple(t)}).catch(e=>{console.error(e),this.botonApple=!1,this.presentApple()})}postVerificarLoginApple(e){this.apiService.postVerificarLoginApple(e).then(e=>{this.botonApple=!1,this.logearse(e,"apple")}).catch(e=>{console.log(e),this.botonApple=!1,this.presentApple()})}presentApple(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Mensaje",message:"Acci\xf3n cancelada",buttons:["OK"]});yield e.present()}))}}return e.\u0275fac=function(t){return new(t||e)(c.Ib(s.g),c.Ib(p.a),c.Ib(n.jb),c.Ib(g.a),c.Ib(u.a),c.Ib(n.mb),c.Ib(d.a),c.Ib(n.ib),c.Ib(n.a),c.Ib(b.a),c.Ib(l.b),c.Ib(h.b))},e.\u0275cmp=c.Cb({type:e,selectors:[["app-login"]],decls:32,vars:3,consts:[[3,"translucent"],[3,"fullscreen"],[1,"conteiner-logo"],["src","./assets/Iconos/LogoBube_final.png","alt","logo bube",1,"img-logo"],[1,"titulo-login",2,"font-size","30px"],[1,"titulo-login"],["id","container",2,"margin-top","20px"],[1,"contenedor"],["expand","block",1,"btn-inicio-sesion",3,"click"],["slot","start","name","logo-facebook"],[1,"text-google"],["class","contenedor",4,"ngIf"],[1,"text-inicio-sesion",3,"click"],[1,"info-paragraph"],["fill","clear",1,"btn-terminos",3,"click"],["expand","block",1,"btn-inicio-apple",3,"disabled","click"],["slot","start","name","logo-apple",2,"color","#000"],["name","crescent",4,"ngIf"],["name","crescent"]],template:function(e,t){1&e&&(c.Jb(0,"ion-header",0),c.Mb(1,"ion-content",1),c.Mb(2,"ion-row"),c.Mb(3,"div",2),c.Jb(4,"ion-img",3),c.Mb(5,"ion-label",4),c.uc(6,"\xdanete"),c.Jb(7,"br"),c.Lb(),c.Mb(8,"ion-label",5),c.uc(9,"a la comunidad de Bube"),c.Lb(),c.Lb(),c.Lb(),c.Mb(10,"div",6),c.Mb(11,"div",7),c.Mb(12,"ion-button",8),c.Ub("click",(function(){return t.loginFacebook()})),c.Jb(13,"ion-icon",9),c.Mb(14,"ion-label",10),c.uc(15,"Iniciar sesi\xf3n con Facebook"),c.Lb(),c.Lb(),c.Lb(),c.sc(16,f,6,2,"div",11),c.Mb(17,"ion-row"),c.Mb(18,"ion-col"),c.Mb(19,"ion-label",12),c.Ub("click",(function(){return t.irOtrosInicios()})),c.uc(20," Otros inicios de sesi\xf3n "),c.Lb(),c.Lb(),c.Lb(),c.Jb(21,"br"),c.Mb(22,"ion-row"),c.Mb(23,"ion-col"),c.Mb(24,"ion-label",13),c.uc(25,"Al registrarse est\xe1s de"),c.Jb(26,"br"),c.uc(27," acuerdo con nuestros"),c.Lb(),c.Lb(),c.Lb(),c.Mb(28,"ion-row"),c.Mb(29,"ion-col"),c.Mb(30,"ion-button",14),c.Ub("click",(function(){return t.terminosYcondiciones()})),c.uc(31,"t\xe9rminos y condiciones"),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Lb()),2&e&&(c.ec("translucent",!0),c.yb(1),c.ec("fullscreen",!0),c.yb(15),c.ec("ngIf",t.showSingApple))},directives:[n.v,n.q,n.Q,n.x,n.G,n.h,n.w,o.k,n.p,n.Z],styles:["ion-content[_ngcontent-%COMP%]{--background:#121212;color:#fff}.conteiner-logo[_ngcontent-%COMP%]{text-align:center;width:100%;left:0;right:0;top:10%;margin-top:20%}.img-logo[_ngcontent-%COMP%]{width:120px;height:120px;margin:auto auto 20px}#container[_ngcontent-%COMP%]{text-align:center;margin-top:10px;left:0;right:0;top:50%}.btn-terminos[_ngcontent-%COMP%]{--color:#fcac19;background:transparent;font-size:14px;font-family:SFUIDisplay-Regular;text-decoration:underline;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;text-transform:none;width:-webkit-min-content;width:-moz-min-content;width:min-content}.btn-terminos[_ngcontent-%COMP%]:hover{background:transparent;color:#fcbd48}.titulo-login[_ngcontent-%COMP%]{color:#f3f2ed;font-family:SF-UI-Display-Black;font-size:20px;margin-top:20px}.p1[_ngcontent-%COMP%]{color:#fff;font-family:SFUIDisplay-Regular;font-size:20px}.info-paragraph[_ngcontent-%COMP%]{margin-bottom:var(--page-margin);color:#b8b7b7;text-align:left;font-family:SFCompactText-Medium;font-size:14px}.info-paragraph[_ngcontent-%COMP%]:last-child{margin-bottom:0}.text-inicio-sesion[_ngcontent-%COMP%]{color:#f3f2ed;text-align:center;font-family:SFCompactText-Medium;font-weight:100;font-size:20px;text-decoration:underline}.contenedor[_ngcontent-%COMP%]{align-content:center;text-align:center;width:100%}.contenedor[_ngcontent-%COMP%]   .btn-inicio-sesion[_ngcontent-%COMP%]{--background:#1877f2;margin-left:30px;margin-right:30px;margin-bottom:20px;font-size:16px;height:50px;text-transform:none;--border-color:#1877f2;--border-style:solid;--border-width:2px;font-family:SFUIDisplay-Regular;--border-radius:5px;--background-activated:#383838}.contenedor[_ngcontent-%COMP%]   .btn-inicio-sesion[_ngcontent-%COMP%]   .text-google[_ngcontent-%COMP%]{font-family:SFUIDisplay-Regular;color:#fff;font-size:16px}.contenedor[_ngcontent-%COMP%]   .btn-inicio-apple[_ngcontent-%COMP%]{--background:#fff;margin-left:30px;margin-right:30px;margin-bottom:20px;height:50px;text-transform:none;--border-color:#fff;--border-style:solid;--border-width:2px;--border-radius:5px;--background-activated:#383838}.contenedor[_ngcontent-%COMP%]   .btn-inicio-apple[_ngcontent-%COMP%]   .text-google[_ngcontent-%COMP%]{font-family:SFUIDisplay-Regular;color:#000;font-size:16px}"]}),e})()}];let y=(()=>{class e{}return e.\u0275mod=c.Gb({type:e}),e.\u0275inj=c.Fb({factory:function(t){return new(t||e)},imports:[[s.i.forChild(v)],s.i]}),e})(),x=(()=>{class e{}return e.\u0275mod=c.Gb({type:e}),e.\u0275inj=c.Fb({factory:function(t){return new(t||e)},imports:[[o.c,r.d,n.gb,y]]}),e})()}}]);